- hosts: all
  sudo: yes

  tasks:
  - name: Install Packages
    apt: name={{ item }} update_cache=yes state=present
    with_items:
      - apache2
      - libapache2-mod-php
      - git
      - curl


  - name: Git Clone Repo
    git: repo=https://github.com/KoenHaemels/ApplicationOnly.git dest=var/ upd$
    register: git_finished

  - shell: rm -r -f /var/www/html/*
    sudo: yes

  - name: copy application
    sudo: yes
    copy: src=/var/ApplicationOnly/WorkingSite/* dest=/var/www/html mode=777
    notify: Restart Apache

  handlers:
  - name: Restart Apache
    service: name=apache2 state=restarted
